{
    "vertShader": [
        "#version 300 es",
        "in vec3 vertexPosition;",
        "in vec3 vertexNormal;",
        "in vec2 vertexUV;",
        "in vec3 vertexBitangent;",
        "\n",
        "uniform mat4 normalMatrix;",
        "uniform mat4 uProjectionMatrix;",
        "uniform mat4 uViewMatrix;",
        "uniform mat4 uModelMatrix;",
        "\n",
        "out vec3 oFragPosition;",
        "out vec3 oNormal;",
        "out vec2 oUV;",
        "out vec3 oVertBitang;",
        "out vec3 normalInterp;",
        "\n",
        "void main() {",
        "\n",
        "    oFragPosition = (uModelMatrix * vec4(vertexPosition, 1.0)).xyz;",
        "    oNormal = normalize((uModelMatrix * vec4(vertexNormal, 1.0)).xyz);",
        "    oUV = vertexUV;",
        "    oVertBitang = vertexBitangent;",
        "    normalInterp = vec3(normalMatrix * vec4(vertexNormal, 0.0));",
        "    gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(vertexPosition, 1.0);",
        "}"
    ],
    "attribs": [
        "vertexPosition",
        "vertexNormal",
        "vertexUV",
        "vertexBitangent"
    ],
    "uniforms": [
        "uProjectionMatrix",
        "uViewMatrix",
        "uModelMatrix",
        "uCameraPosition",
        "normalMatrix",
        "numLights",
        "diffuseVal",
        "ambientVal",
        "specularVal",
        "nVal",
        "uTexture",
        "uTextureNorm",
        "uLightPositions",
        "uLightColours",
        "uLightStrengths"
    ],
    "fragShader": [
        "#version 300 es",
        "#define MAX_LIGHTS 128",
        "precision highp float;",
        "\n",
        "in vec3 oFragPosition;",
        "in vec3 oNormal;",
        "in vec2 oUV;",
        "in vec3 oVertBitang;",
        "in vec3 normalInterp;",
        "\n",
        "uniform vec3 uCameraPosition;",
        "uniform int numLights;",
        "uniform vec3 diffuseVal;",
        "uniform vec3 ambientVal;",
        "uniform vec3 specularVal;",
        "uniform float nVal;",
        "uniform sampler2D uTexture;",
        "uniform sampler2D uTextureNorm;",
        "uniform vec3 uLightPositions[MAX_LIGHTS];",
        "uniform vec3 uLightColours[MAX_LIGHTS];",
        "uniform float uLightStrengths[MAX_LIGHTS];",
        "\n",
        "out vec4 fragColor;",
        "\n",
        "void main() {",
        "    vec3 normal;",
        "    vec3 regularNormal;",
        "    vec3 ambient = vec3(0,0,0);",
        "    vec3 diffuse = vec3(0,0,0);",
        "    vec3 specular = vec3(0,0,0);",
        "\n",
        "   regularNormal = normalize(normalInterp);",
        "\n",
        "    normal = texture(uTextureNorm, oUV).xyz;",
        "    normal = 2.0 * normal - 1.0;",
        "    normal = normal * vec3(5.0, 5.0, 5.0);",
        "    vec3 biTangent = cross(oNormal, oVertBitang);",
        "    mat3 nMatrix = mat3(oVertBitang, biTangent, oNormal);",
        "    normal = normalize(nMatrix * normal);",
        "\n",
        "    for (int i = 0; i < numLights; i++) {",
        "        vec3 nCameraPosition = normalize(uCameraPosition); // Normalize the camera position",
        "        vec3 V = normalize(nCameraPosition - oFragPosition);",
        "\n",
        "        vec3 lightDirection = normalize(uLightPositions[i] - oFragPosition);",
        "        float diff = max(dot(lightDirection, regularNormal + normal), 0.0);",
        "        vec3 reflectDir = reflect(-lightDirection, normal);",
        "        float spec = pow(max(dot(V, reflectDir), 0.0), nVal);",
        "        float lightDistance = length(uLightPositions[i] - oFragPosition);",
        "        float attenuation = 1.0 / (lightDistance * lightDistance);",
        "        attenuation *= uLightStrengths[i] + 0.1;",
        "\n",
        "        //ambient",
        "        ambient += (ambientVal * uLightColours[i]) * diffuseVal;",
        "        //diffuse",
        "        diffuse += diffuseVal + uLightColours[i] * diff;",
        "\n",
        "        if (diff > 0.0f)",
        "        {",
        "            specular += specularVal * uLightColours[i] * spec;",
        "            specular *= attenuation;",
        "        }",
        "\n",
        "        ambient *= attenuation; //causes much darker scene",
        "        diffuse *= attenuation;",
        "    }",
        "\n",
        "   vec4 textureColor = texture(uTexture, oUV);",
        "\n",
        "   fragColor = vec4((ambient + diffuse + specular) * textureColor.rgb, 1.0);",
        "\n",
        "}"
    ]
}